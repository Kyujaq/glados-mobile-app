# Repository Guidelines

## Project Structure & Module Organization

Keep all application code under `src/` (create the folder if it does not exist yet). Organize features in `src/features/<feature>` and reusable UI in `src/components/`. Platform overrides should use React Native suffixes like `Player.android.tsx` and `Player.ios.tsx`. Store images, audio prompts, and JSON fixtures in `assets/` (create if missing) and import with static `require` calls. Native tooling generated by the React Native CLI lives in `android/` and `ios/`; avoid editing build files unless you are working on platform integration.

## Build, Test, and Development Commands

- `npm run start`: launches Metro bundler on the default port.
- `npm run android` / `npm run ios`: builds and deploys to the selected emulator or device.
- `npm run lint`: runs ESLint with `@react-native/eslint-config`.
- `npm test`: executes the Jest suite in watch mode when a terminal is interactive.

## Coding Style & Naming Conventions

Use TypeScript throughout with strict typing of props and state. Code is formatted with Prettier (run `npx prettier --write src`) and linted with ESLint; keep imports ordered and resolve warnings before opening a PR. Stick to 2-space indentation, PascalCase for components/screens, camelCase for functions and variables, and SCREAMING_SNAKE_CASE for constants and env keys. Place hooks in `src/hooks/` named `useThing.ts`.

## Testing Guidelines

Write unit tests with Jest plus `react-test-renderer`; name files `<Component>.test.tsx` inside `__tests__` folders adjacent to the code. Stub network calls and audio streaming with mocks under `src/test-utils/`. Target 80% line coverage and update snapshots with `npm test -- -u` only when intentional.

## Commit & Pull Request Guidelines

Follow the existing imperative style seen in `Initial commit: Add README and package.json`; keep the subject under 72 characters and explain the why in the body when needed. Reference GitHub issues as `Fixes #123`. Pull requests should include: a concise summary, screenshots or screen recordings for UI work, test plan results (`npm test` / `npm run lint`), and notes about Tailscale or backend configuration changes.

## Environment & Configuration

Develop against Node 18+ and the React Native CLI. Store secrets such as Tailscale auth keys in `.env.local` and document required values in the PR description rather than committing them. Update environment files using the keys below and keep non-secret defaults in version control only when helpful:

- `API_BASE_URL`, `STT_PATH`, `TTS_PATH`, `TEXT_CHAT_PATH`, `HEALTH_PATH`
- `TAILSCALE_HOSTNAME`, `TAILSCALE_IP`, `TAILSCALE_PORT`, `USE_TLS`
- `API_AUTH_TOKEN` for bearer auth (never commit real tokens)

Run `npm run lint` and `npm test` before opening a PR; the transport tests assert URL resolution, headers, and basic streaming behaviour. Use the in-app **Settings** tab to verify connectivity against a tailnet hostâ€”changes persist to AsyncStorage and reconfigure the shared transport automatically.
